{
  "hash": "bb072abbf158c003bc87947185937f9b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Clase práctica Semana 12\"\nauthor: \"Santiago Sotelo y Nadia Duffó\"\nformat: html\nexecute: \n  echo: true\ndf-print: paged\ncode-annotations: hover\n---\n\n\n\n\n::: callout-note\n## Material para el ejercicio\n\nDescarga la carpeta .zip para acceder al material de esta sesión. Haga click en el siguiente [enlace](https://downgit.github.io/#/home?url=https://github.com/aito123/CCO221_web/tree/master/semana12_material). No olvides unzipear el archivo.\n:::\n\n# Estadística bivariada:\n# Chi-cuadrado\n\nPermite evaluar si existe una *asociación estadística* entre *dos* variables *categóricas.* Para esto, compara las *frecuencias observadas* con las *frecuencias esperadas*. \n\nBajo el supuesto de independencia, si las diferencias son suficientemente grandes, se concluye que las variables están asociadas.\n\nHaremos una evaluación. Primero, preparamos todos los insumos que necesitaremos y ya conocemos (carga de paquetes, importación y exploración de data)\n\n## Cargar paquetes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(rio, dplyr, ggplot2)\n```\n:::\n\n\n\n\n## Importación de data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- import(\"data/filmaffinity_dataset_limpio.xlsx\")\n```\n:::\n\n\n\n\n## Exploración de data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 119,003\nColumns: 11\n$ index        <dbl> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16,…\n$ Título       <chr> \"'49-'17\", \"10,000 Years B.C. (C)\", \"1812\", \"20.000 legua…\n$ Año          <dbl> 1917, 1916, 1912, 1907, 1909, 1916, 1912, 1916, 1908, 191…\n$ País         <chr> \"Estados Unidos\", \"Estados Unidos\", \"Rusia\", \"Francia\", \"…\n$ Dirección    <chr> \"Ruth Ann Baldwin\", \"Willis H. O'Brien\", \"Vasili Goncharo…\n$ Reparto      <chr> \"Joseph W. Girard, Leo Pierson, William Dyer, Mattie Witt…\n$ Nota         <dbl> NA, 5.1, NA, 6.0, 5.3, NA, 5.4, NA, 4.6, NA, 5.8, NA, NA,…\n$ `Tipo filme` <chr> \"Película\", \"Cortometraje\", \"Película\", \"Cortometraje\", \"…\n$ Género       <chr> \"Western\", \"Comedia\", \"Drama\", \"Fantástico\", \"Comedia\", \"…\n$ Nota_cat     <chr> \"Sin nota\", \"5 a más\", \"Sin nota\", \"5 a más\", \"5 a más\", …\n$ continente   <chr> \"América\", \"América\", \"Asia\", \"Europa\", \"Europa\", \"Améric…\n```\n\n\n:::\n:::\n\n\n\n\n## Chi cuadrado\n\nGeneramos una tabla de frecuencias observadas\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf2 <- df %>% \n  filter(Nota_cat != \"Sin nota\")\ntabla1 <- table(df2$Nota_cat, df2$continente)\nprint(tabla1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \n             África América  Asia Europa Oceanía\n  5 a más       139   22760  6066  18442     459\n  Menos de 5     39   12189  1241   6707     252\n```\n\n\n:::\n:::\n\n\n\n\nGeneramos una tabla de frecuencias esperadas\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntabla2 <- chisq.test(tabla1)$expected\nprint(tabla2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \n               África  América     Asia    Europa  Oceanía\n  5 a más    124.7569 24495.11 5121.341 17626.468 498.3267\n  Menos de 5  53.2431 10453.89 2185.659  7522.532 212.6733\n```\n\n\n:::\n:::\n\n\n\n\nRealizamos la prueba\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchisq.test(tabla1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test\n\ndata:  tabla1\nX-squared = 1135.4, df = 4, p-value < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\nComprobamos con proporciones\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntabla1 %>% \n  prop.table(2) %>% \n  round(3)*100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            \n             África América Asia Europa Oceanía\n  5 a más      78.1    65.1 83.0   73.3    64.6\n  Menos de 5   21.9    34.9 17.0   26.7    35.4\n```\n\n\n:::\n:::\n\n\n\n\n# Trabajo grupal: exploración de nuestra data\n\n## Carga de paquetes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(rio, dplyr, tidyr, labelled, tibble, questionr)\n```\n:::\n\n\n\n\n## Importación de base de KoboToolbox\n\nDebemos primero importar nuestra base de datos descargada desde Kobo.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- import(\"data/base_ejemplo.xlsx\")\n```\n:::\n\n\n\n\n## Exploración inicial de data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(df)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(df)\n```\n:::\n\n\n\n\n## Cambio de encabezados\n\nCambiar los nombres de variables a nombres más cortos nos permitirá un mejor manejo de la base.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nencabezados <- c('start',\n                 'end',\n                 'P1',\n                 'P2',\n                 'P3',\n                 'P4',\n                 'P4_1',\n                 'P4_2',\n                 'P4_3',\n                 'P4_4',\n                 'P4_5',\n                 'P4_6',\n                 'P4_7',\n                 'P4_8',\n                 '_id',\n                 '_uuid',\n                 '_submission_time',\n                 '_validation_status',\n                 '_notes',\n                 '_status',\n                 '_submitted_by',\n                 '__version__',\n                 '_tags',\n                 '_index')\ndf2 <- df\nnames(df2) <- encabezados\n```\n:::\n\n\n\n\n## Configuración de etiquetas de variables\n\nAdemás del nombre, podemos añadir etiquetas a las columnas.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\netiquetas_columnas <- list(start = 'start',\n                   end = 'end',\n                   P1 = 'Título del videojuego',\n                   P2 = 'Año de lanzamiento (tráiler)',\n                   P3 = 'Empresa',\n                   P4 = 'Género',\n                   P4_1 = 'Shooter',\n                   P4_2 = 'Acción y aventura',\n                   P4_3 = 'Terror',\n                   P4_4 = 'Plataformas',\n                   P4_5 = 'Simulación',\n                   P4_6 = 'Rol',\n                   P4_7 = 'Peleas',\n                   P4_8 = 'Ninguno de los anteriores',\n                   `_id` = '_id',\n                   `_uuid` = '_uuid',\n                   `_submission_time` = '_submission_time',\n                   `_validation_status` = '_validation_status',\n                   `_notes` = '_notes',\n                   `_status` = '_status',\n                   `_submitted_by` = '_submitted_by',\n                   `__version__` = '__version__',\n                   `_tags` = '_tags',\n                   `_index` = '_index')\n\ndf3 <- df2\nvar_label(df3) <- etiquetas_columnas\n```\n:::\n\n\n\n\n## Tablas de respuesta múltiple\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf3 %>% \n  select(starts_with('P4_')) %>% \n  multi.table(., digits = 1) %>% \n  as.data.frame(.) %>% \n  rownames_to_column(. , 'Género') %>%\n  mutate(Género = unlist(etiquetas_columnas[.$Género]))\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}